<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>JavaWeb-08 Servlet高级 | string</title><meta name="keywords" content="博客"><meta name="author" content="mr.bai"><meta name="copyright" content="mr.bai"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="学习教程">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaWeb-08 Servlet高级">
<meta property="og:url" content="https://string32.github.io/2021/11/18/javaweb/javaweb08/index.html">
<meta property="og:site_name" content="string">
<meta property="og:description" content="学习教程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://string32.github.io/img/pj.png">
<meta property="article:published_time" content="2021-11-18T14:37:00.000Z">
<meta property="article:modified_time" content="2021-11-20T06:24:19.303Z">
<meta property="article:author" content="mr.bai">
<meta property="article:tag" content="博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://string32.github.io/img/pj.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://string32.github.io/2021/11/18/javaweb/javaweb08/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JavaWeb-08 Servlet高级',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-20 14:24:19'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/constown/HexoCustomFile@0.0.4/dist/css/custom.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://images.wallpaperscraft.com/image/single/wolf_wolves_predators_fog_snow_mountains_116660_1920x1080.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/./img/pj.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">string</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 链接</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JavaWeb-08 Servlet高级</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-11-18T14:37:00.000Z" title="发表于 2021-11-18 22:37:00">2021-11-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-11-20T06:24:19.303Z" title="更新于 2021-11-20 14:24:19">2021-11-20</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JavaWeb-08 Servlet高级"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="1-实现第一个Filter"><a href="#1-实现第一个Filter" class="headerlink" title="1.实现第一个Filter"></a>1.实现第一个Filter</h2><p>首先在Eclipse中创建一个名为chapter08的Web项目，然后在该项目的src目录下创建一个名为pidan.filter包，<br>最后在该包下创建一个名为MyServlet的Servlet 类，该类用于访问时在浏览器中输出“Hello MyServlet”。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyServlet extends HttpServlet &#123;</span><br><span class="line">	private static final long serialVersionUID = 1L;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		response.getWriter().print(&quot;hello dashuju2004-------pidan&lt;br /&gt;&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		// TODO Auto-generated method stub</span><br><span class="line">		doGet(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在web.xml文件中对Servlet进行如下配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">		&lt;description&gt;&lt;/description&gt;</span><br><span class="line">		&lt;display-name&gt;MyServlet&lt;/display-name&gt;</span><br><span class="line">		&lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;pidan.filter.MyServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>启动Tomcat 服务器，在浏览器的地址栏中输入地址“<a target="_blank" rel="noopener" href="http://localhost:8080/chapterO8/MyServlet%E2%80%9D">http://localhost:8080/chapterO8/MyServlet”</a></p>
<p>在pidan.filter包中创建一个名为MyFilter的Fiter类，该类用于拦截MyServlet程序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">	public void destroy() &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">		System.out.println(&quot;拦截了原网站的响应&quot;);</span><br><span class="line">		response.getWriter().print(&quot;这是filter输出到网页的内容&quot;);</span><br><span class="line">		</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤器程序与Servlet程序类似，同样需要在 web.xml文件中进行配置，从而设置它所能拦截的资源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">		&lt;filter-name&gt;MyFilter&lt;/filter-name&gt;</span><br><span class="line">		&lt;filter-class&gt;pidan.filter.MyFilter&lt;/filter-class&gt;</span><br><span class="line">	&lt;/filter&gt;</span><br><span class="line">	&lt;filter-mapping&gt;</span><br><span class="line">		&lt;filter-name&gt;MyFilter&lt;/filter-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>

<p>在上述代码中，过滤器的配置信息中包含多个元素，这些元素分别具有不同的作用，具体如下。</p>
<blockquote>
<p><filter>根元素用于注册一个Filter。<br><filter-name>子元素用于设置Filter名称。<br><filter-class>子元素用于设置Filter类的完整名称。<br><filter-mapping>根元素用于设置一个过滤器所拦截的资源。<br><filter-name>子元素必须与<filter>中的<filter-name>子元素相同。<br><url-pattern>子元素用于匹配用户请求的URL,例如“/MyServlet”，这个URL还可以使用通配符“<em>”来表示，例如“</em>.do”适用于所有以“.do”结尾的Servlet路径。</p>
</blockquote>
<p>重新启动Tomcat 服务器，在浏览器访问MyServlet</p>
<h2 id="2-Filter映射"><a href="#2-Filter映射" class="headerlink" title="2.Filter映射"></a>2.Filter映射</h2><p>2.1拦截不同方式的访问请求<br>    在web.xml文件中，一个<filter-mapping>元素用于配置一个Fiter所负责拦截的资源。<br><filter-mapping>元素中有一个特殊的子元素<dispatcher>,该元素用于指定过滤器所拦截的资源被Servlet容器调用的方式，、<br><dispatcher>元素的值共有4个：</p>
<blockquote>
<p>REQUEST<br>当用户直接访问页面时，Web容器将会调用过滤器。如果目标资源是通过RequestDispatcher的include()或 forward()方法访问的，那么该过滤器将不会被调用。<br>INCLUDE<br>如果目标资源是通过RequestDispatcher的 include()方法访问的，那么该过滤器将被调用。<br>除此之外，该过滤器不会被调用。<br>FORWARD<br>如果目标资源是通过RequestDispatcher的forward()方法访问的，那么该过滤器将被调用。<br>除此之外，该过滤器不会被调用。<br>ERROR<br>如果目标资源是通过声明式异常处理机制调用的，那么该过滤器将被调用。除此之外，过滤器不会被调用。</p>
</blockquote>
<p>在chapter08项目的pidan.filter包中，<br>创建一个名为ForwardServlet的Servlet类，该类用于将请求转发给first.jsp页面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class ForwardServlet extends HttpServlet &#123;</span><br><span class="line">	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		request.getRequestDispatcher(&quot;/first.jsp&quot;).forward(request,response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		doGet(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在web.xml文件中，配置ForwardServlet信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">		&lt;servlet-name&gt;ForwardServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;servlet-class&gt;pidan.filter.ForwardServlet&lt;/servlet-class&gt;</span><br><span class="line">	&lt;/servlet&gt;</span><br><span class="line">	&lt;servlet-mapping&gt;</span><br><span class="line">		&lt;servlet-name&gt;ForwardServlet&lt;/servlet-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/ForwardServlet&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>在WebContent目录中创建一个first.jsp页面，该页面用于输出内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	first.jsp</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>在pidan.filter包中，创建一个过滤器ForwardFiter.java,该过滤器专门用于对first.jsp页面进行拦截</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line">public class ForwardFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">	public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		PrintWriter out=response.getWriter();</span><br><span class="line">		out.write(&quot;Hello FilterYest&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在web.xml文件中，配置过滤器的映射信息，拦截first.jsp页面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">		&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">		&lt;filter-class&gt;pidan.filter.ForwardFilter&lt;/filter-class&gt;</span><br><span class="line">	&lt;/filter&gt;</span><br><span class="line">	&lt;filter-mapping&gt;</span><br><span class="line">		&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">		&lt;url-pattern&gt;/first.jsp&lt;/url-pattern&gt;</span><br><span class="line">	&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>启动Tomcat 服务器，在浏览器访问ForwardServlet</p>
<p>浏览器可以正常访问JSP页面，说明ForwardFilter没有拦截到ForwardServlet转发的first.jsp页面。<br>为了拦截ForwardServlet通过forward(）方法转发的first.jsp页面，需要在web.xml文件中的对应过滤器配置信息中增加一个<dispatcher>子元素，将该元素的值设置为FORWARD</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">	&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">	&lt;filter-class&gt;pidan.filter.ForwardFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">	&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/first.jsp&lt;/url-pattern&gt;</span><br><span class="line">	&lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>浏览器窗口显示的是ForwardFilter类中的内容，而first.jsp页面的输出内容没有显示。<br>由此可见,ForwardServlet中通过 forward()方法转发的 first.jsp页面被成功拦截了。</p>
<h2 id="3-Filter链"><a href="#3-Filter链" class="headerlink" title="3.Filter链"></a>3.Filter链</h2><p>3.1 在 chapter08 项目的pidan.filter 包中新建两个过滤器 MyFilter01 和MyFilter02</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line">public class MyFilter01 implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">   </span><br><span class="line">	public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		PrintWriter out=response.getWriter();</span><br><span class="line">		out.write(&quot;Hello MyFilter01&lt;br /&gt;&quot;);</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pidan.filter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter02</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">   </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">		PrintWriter out=response.getWriter();</span><br><span class="line">		out.write(<span class="string">&quot;MyFilter02 Before&lt;br /&gt;&quot;</span>);</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">		out.write(<span class="string">&quot;MyFilter02 After&lt;br /&gt;&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了防止其他过滤器影响此次Filter链的演示效果，请先在web.xml文件中注释掉其他过滤器的配置信息。<br>然后，将MyFilter01和MyFilter02过滤器的映射信息配置在MyServlet配置信息前面</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter01&lt;/filter-name&gt;</span><br><span class="line">	&lt;filter-class&gt;pidan.filter.MyFilter01&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter01&lt;/filter-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line">&lt;filter&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter02&lt;/filter-name&gt;</span><br><span class="line">	&lt;filter-class&gt;pidan.filter.MyFilter02&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter02&lt;/filter-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>MyServlet首先被MyFilter01拦截了，打印出MyFilter01中的内容，然后被MyFilter02拦截，<br>直到MyServlet被MyFilterO2放行后，浏览器才显示出MyServlet中的输出内容。 </p>
<h2 id="4-FilterConfig接口"><a href="#4-FilterConfig接口" class="headerlink" title="4.FilterConfig接口"></a>4.FilterConfig接口</h2><p>在 chapter08项目的pidan.filter包中创建过滤器MyFilter03,来获取 web.xml中设置的参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyFilter03 implements Filter &#123;</span><br><span class="line">	private String characterEncoding;</span><br><span class="line">	FilterConfig fc;</span><br><span class="line"> </span><br><span class="line">	public void destroy() &#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		characterEncoding=fc.getInitParameter(&quot;encoding&quot;);</span><br><span class="line">		System.out.println(&quot;encoding 初始化参数的值为：&quot;+characterEncoding);</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">		this.fc=fConfig;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在 web.xml文件中配置过滤器信息。由于Filter链中各个Filter的拦截顺序与它们在web.xml文件中<fiter-mapping>元素的映射顺序一致，<br>因此,为了防止其他Filter影响MyFilter03的拦截效果，这里将MyFilter03映射信息配置在web.xml文件最前端</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter03&lt;/filter-name&gt;</span><br><span class="line">	&lt;filter-class&gt;pidan.filter.MyFilter03&lt;/filter-class&gt;</span><br><span class="line">	&lt;init-param&gt;</span><br><span class="line">		&lt;param-name&gt;encoding&lt;/param-name&gt;</span><br><span class="line">		&lt;param-value&gt;GBK&lt;/param-value&gt;</span><br><span class="line">	&lt;/init-param&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">	&lt;filter-name&gt;MyFilter03&lt;/filter-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>使用Filter获取到了配置文件中的初始化参数。当Tomcat服务器启动时，会加载所有的Web应用，<br>当加载到chapter08这个Web应用时，MyFiter03就会被初始化调用 init()方法，从而可以得到FilterConfig 对象。<br>然后在doFilter()方法中通过调用FilterConfig对象的qetlnitParameter()方法便可以获取在web.xml文件中配置的某个参数信息。</p>
<h2 id="5-任务——使用Filter实现用户自动登录"><a href="#5-任务——使用Filter实现用户自动登录" class="headerlink" title="5.任务——使用Filter实现用户自动登录"></a>5.任务——使用Filter实现用户自动登录</h2><p>5.1 编写User类<br>   在chapter08项目中创建pidan.entity包，在该包中编写User 类，该类用于封装用户的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package pidan.entity;</span><br><span class="line"> </span><br><span class="line">public class User &#123;</span><br><span class="line">	private String username;</span><br><span class="line">	private String password;</span><br><span class="line">	public String getUsername() &#123;</span><br><span class="line">		return username;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setUsername(String username) &#123;</span><br><span class="line">		this.username = username;</span><br><span class="line">	&#125;</span><br><span class="line">	public String getPassword() &#123;</span><br><span class="line">		return password;</span><br><span class="line">	&#125;</span><br><span class="line">	public void setPassword(String password) &#123;</span><br><span class="line">		this.password = password;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5.2 实现登录页面和首页<br>(1).在chapter08项目的WebContent根目录中，编写login.jsp页面，该页面用于创建一个用户登录的表单，<br>这个表单需要填写用户名和密码，以及用户自动登录的时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">	pageEncoding=&quot;utf-8&quot; import=&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;/head&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">	&lt;h3&gt;用户登录&lt;/h3&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;body style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">	&lt;form action=&quot;$&#123;pageContext.request.contextPath &#125;/LoginServlet&quot;</span><br><span class="line">		method=&quot;post&quot;&gt;</span><br><span class="line">		&lt;table border=&quot;1&quot; width=&quot;600px&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;</span><br><span class="line">			align=&quot;center&quot;&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;td height=&quot;30&quot; align=&quot;center&quot;&gt;用户名：&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;$&#123;errorMsg &#125;&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;td height=&quot;30&quot; align=&quot;center&quot;&gt;密 &amp;nbsp; 码：&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;td height=&quot;35&quot; align=&quot;center&quot;&gt;自动登录时间&lt;/td&gt;</span><br><span class="line">				&lt;td&gt;&lt;input type=&quot;radio&quot; name=&quot;autologin&quot;</span><br><span class="line">					value=&quot;$&#123;60*60*24*31 &#125;&quot; /&gt;一个月 &lt;input type=&quot;radio&quot; name=&quot;autologin&quot;</span><br><span class="line">					value=&quot;$&#123;60*60*24*31*3 &#125;&quot; /&gt;三个月 &lt;input type=&quot;radio&quot;</span><br><span class="line">					name=&quot;autologin&quot; value=&quot;$&#123;60*60*24*31*6 &#125;&quot; /&gt;半年 &lt;input</span><br><span class="line">					type=&quot;radio&quot; name=&quot;autologin&quot; value=&quot;$&#123;60*60*24*31*12 &#125;&quot; /&gt;一年&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">			&lt;tr&gt;</span><br><span class="line">				&lt;td height=&quot;30&quot; colspan=&quot;2&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot;</span><br><span class="line">					value=&quot;登录&quot; /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;reset&quot;</span><br><span class="line">					value=&quot;重置&quot; /&gt;&lt;/td&gt;</span><br><span class="line">			&lt;/tr&gt;</span><br><span class="line">		&lt;/table&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;html&gt;</span><br></pre></td></tr></table></figure>
<p>(2).在chapter08项目的WebContent根目录中，编写index.jsp页面，该页面用于显示用户的登录信息。<br>如果没有用户登录，在index.jsp页面中就显示一个用户登录的超链接。如果用户已经登录，在 index.isp页面中显示登录的用户名，以及一个注销的超链接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  &lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">	pageEncoding=&quot;utf-8&quot; import=&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;显示登录的用户信息&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;br /&gt;</span><br><span class="line">	&lt;center&gt;</span><br><span class="line">		&lt;h3&gt;欢迎光临&lt;/h3&gt;</span><br><span class="line">	&lt;/center&gt;</span><br><span class="line">	&lt;br /&gt;</span><br><span class="line">	&lt;c:choose&gt;</span><br><span class="line">		&lt;c:when test=&quot;$&#123;sessionScope.user==null &#125;&quot;&gt;</span><br><span class="line">			&lt;a href=&quot;http://localhost:9999/chap08/login.jsp&quot;&gt;用户登录&lt;/a&gt;</span><br><span class="line">		&lt;/c:when&gt;</span><br><span class="line">		&lt;c:otherwise&gt;</span><br><span class="line">				欢迎您：$&#123;sessionScope.user.username&#125;    &lt;a</span><br><span class="line">				href=&quot;http://localhost:9999/chap08/LogoutServlet&quot;&gt;退出&lt;/a&gt;</span><br><span class="line">		&lt;/c:otherwise&gt;</span><br><span class="line">	&lt;/c:choose&gt;</span><br><span class="line">	&lt;hr /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>6.创建Servlet<br>(1)编写LoginServlet类<br>在chapter08项目的pidan.filter包中，编写LoginServlet类，该类用于处理用户的登录请求。<br>如果输入的用户名和密码正确，则发送一个用户自动登录的Cookie，并跳转到首页；否则会提示输入的用户名或密码错误，<br>并跳转至登录页面login.jsp让用户重新登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line">import pidan.entity.User;</span><br><span class="line"> </span><br><span class="line">public class LoginServlet extends HttpServlet &#123;</span><br><span class="line"> </span><br><span class="line">    public LoginServlet() &#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		String username = request.getParameter(&quot;username&quot;);</span><br><span class="line">		String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">		if (&quot;pidan&quot;.equals(username) &amp;&amp; &quot;666666&quot;.equals(password)) &#123;</span><br><span class="line">			User user = new User();</span><br><span class="line">			user.setUsername(username);</span><br><span class="line">			user.setPassword(password);</span><br><span class="line">			request.getSession().setAttribute(&quot;user&quot;, user);</span><br><span class="line">			String autoLogin = request.getParameter(&quot;autoLogin&quot;);</span><br><span class="line">			if (autoLogin != null) &#123;</span><br><span class="line">				Cookie cookie = new Cookie(autoLogin, username + &quot;-&quot;+password);</span><br><span class="line">				cookie.setMaxAge(Integer.parseInt(autoLogin));</span><br><span class="line">				cookie.setPath(request.getContextPath());</span><br><span class="line">				response.addCookie(cookie);</span><br><span class="line">			&#125;</span><br><span class="line">			response.sendRedirect(request.getContextPath()+&quot;/index.jsp&quot;);</span><br><span class="line">		&#125;else &#123;</span><br><span class="line">			request.setAttribute(&quot;errerMsg&quot;, &quot;用户名或密码错误&quot;);</span><br><span class="line">			request.getRequestDispatcher(&quot;/login.jsp&quot;).forward(request, response);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">		doGet(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>7.创建过滤器<br>在chapter08项目的pidan.filter包中，编写AutoLoginFilter类，该类用于拦截用户登录的访问请求，<br>判断请求中是否包含用户自动登录的Cookie。<br>如果包含，则获取Cookie中的用户名和密码，并验证用户名和密码是否正确。如果正确，则将用户的登录信息封装到User对象存入Session域中，完成用户自动登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line">import javax.servlet.annotation.WebFilter;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line">import pidan.entity.User;</span><br><span class="line"> </span><br><span class="line">public class AutoLoginFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">	public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void doFilter(ServletRequest req, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">		HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">		Cookie[] cookies = request.getCookies();</span><br><span class="line">		String autologin = null;</span><br><span class="line">		for (int i = 0; cookies != null &amp;&amp; i&lt;cookies.length;i++) &#123;</span><br><span class="line">			if (&quot;autologin&quot;.equals(cookies[i].getValue())) &#123;</span><br><span class="line">				autologin = cookies[i].getValue();</span><br><span class="line">				break;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		if (autologin != null) &#123;</span><br><span class="line">			String[] parts = autologin.split(&quot;-&quot;);</span><br><span class="line">			String username = parts[0];</span><br><span class="line">			String password = parts[1];</span><br><span class="line">			if (&quot;pidan&quot;.equals(username)&amp;&amp;(&quot;666666&quot;).equals(password)) &#123;</span><br><span class="line">				User user = new User();</span><br><span class="line">				user.setUsername(username);</span><br><span class="line">				user.setPassword(password);</span><br><span class="line">				request.getSession().setAttribute(&quot;user&quot;, user);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		chain.doFilter(request, response);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>8.配置映射信息<br>    在web.xml文件中，配置所有相关Servlet及AutoLoginFilter过滤器信息。<br>由于要拦截用户访问资源的所有请求，因此，将过滤器<filter-mapping>元素拦截的路径设置为“/”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">	&lt;filter-name&gt;AutoLoginFilter&lt;/filter-name&gt;</span><br><span class="line">	&lt;filter-class&gt;pidan.filter.AutoLoginFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">	&lt;filter-name&gt;AutoLoginFilter&lt;/filter-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;pidan.filter.LoginServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">	&lt;servlet-name&gt;LogoutServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;servlet-class&gt;pidan.filter.LogouServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">	&lt;servlet-name&gt;LogoutServlet&lt;/servlet-name&gt;</span><br><span class="line">	&lt;url-pattern&gt;/LogoutServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>9.运行项目，查看结果<br>(1)访问login.jsp页面<br>重启服务器，打开IE浏览器在地址栏中输入“<a target="_blank" rel="noopener" href="http://localhost:8888/chapter08/login.jsp%E2%80%9D%EF%BC%8C">http://localhost:8888/chapter08/login.jsp”，</a><br>此时，浏览器窗口中会显示一个用户登录的表单，在这个表单中输入用户名“baixiao”、密码“123456”，并选择用户自动登录的时间<br>(2)实现登录<br>    点击登录按钮，便可完成自动登录<br>(3)注销用户<br>    单击图中的【注销】超链接，就可以注销当前的用户，然后显示index.jsp页面</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">mr.bai</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://string32.github.io/2021/11/18/javaweb/javaweb08/">https://string32.github.io/2021/11/18/javaweb/javaweb08/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://string32.github.io" target="_blank">string</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/./img/pj.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/11/10/javaweb/javaweb07/"><img class="next-cover" src="/./img/bz.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JavaWeb-07 EL表达式和JSTL</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NDYzMy8zMTEwNA=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://images.wallpaperscraft.com/image/single/wolf_wolves_predators_fog_snow_mountains_116660_1920x1080.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">mr.bai</div><div class="author-info__description">这是一个懒惰的打字员</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/string32"><i class="fab fa-github"></i><span>关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/string32" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:xxxxxx@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到白小锋的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AE%9E%E7%8E%B0%E7%AC%AC%E4%B8%80%E4%B8%AAFilter"><span class="toc-number">1.</span> <span class="toc-text">1.实现第一个Filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Filter%E6%98%A0%E5%B0%84"><span class="toc-number">2.</span> <span class="toc-text">2.Filter映射</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Filter%E9%93%BE"><span class="toc-number">3.</span> <span class="toc-text">3.Filter链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-FilterConfig%E6%8E%A5%E5%8F%A3"><span class="toc-number">4.</span> <span class="toc-text">4.FilterConfig接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E4%BB%BB%E5%8A%A1%E2%80%94%E2%80%94%E4%BD%BF%E7%94%A8Filter%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E8%87%AA%E5%8A%A8%E7%99%BB%E5%BD%95"><span class="toc-number">5.</span> <span class="toc-text">5.任务——使用Filter实现用户自动登录</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/11/18/javaweb/javaweb08/" title="JavaWeb-08 Servlet高级"><img src="/./img/pj.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JavaWeb-08 Servlet高级"/></a><div class="content"><a class="title" href="/2021/11/18/javaweb/javaweb08/" title="JavaWeb-08 Servlet高级">JavaWeb-08 Servlet高级</a><time datetime="2021-11-18T14:37:00.000Z" title="发表于 2021-11-18 22:37:00">2021-11-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/10/javaweb/javaweb07/" title="JavaWeb-07 EL表达式和JSTL"><img src="/./img/bz.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JavaWeb-07 EL表达式和JSTL"/></a><div class="content"><a class="title" href="/2021/11/10/javaweb/javaweb07/" title="JavaWeb-07 EL表达式和JSTL">JavaWeb-07 EL表达式和JSTL</a><time datetime="2021-11-10T14:37:00.000Z" title="发表于 2021-11-10 22:37:00">2021-11-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/09/javaweb/javaweb06/" title="JavaWeb-06 JSP技术"><img src="/./img/bz.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JavaWeb-06 JSP技术"/></a><div class="content"><a class="title" href="/2021/11/09/javaweb/javaweb06/" title="JavaWeb-06 JSP技术">JavaWeb-06 JSP技术</a><time datetime="2021-11-09T14:37:00.000Z" title="发表于 2021-11-09 22:37:00">2021-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/06/Markdown%E5%AD%A6%E4%B9%A0/Markdown%E6%95%99%E7%A8%8B/" title="Markdown教程"><img src="/./img/bz.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Markdown教程"/></a><div class="content"><a class="title" href="/2021/11/06/Markdown%E5%AD%A6%E4%B9%A0/Markdown%E6%95%99%E7%A8%8B/" title="Markdown教程">Markdown教程</a><time datetime="2021-11-06T14:37:00.000Z" title="发表于 2021-11-06 22:37:00">2021-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/06/javaweb/javaweb05/" title="JavaWeb-05 会话及其会话技术"><img src="/./img/bz.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JavaWeb-05 会话及其会话技术"/></a><div class="content"><a class="title" href="/2021/11/06/javaweb/javaweb05/" title="JavaWeb-05 会话及其会话技术">JavaWeb-05 会话及其会话技术</a><time datetime="2021-11-06T14:37:00.000Z" title="发表于 2021-11-06 22:37:00">2021-11-06</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('/./img/pj.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By mr.bai</div><div class="footer_custom_text">很高兴认识你😀</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><div class="aplayer no-destroy" data-id="000PeZCQ1i4XVs" data-server="tencent" data-type="artist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>