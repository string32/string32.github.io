<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JavaWeb-08 Servlet高级</title>
      <link href="/2021/11/18/javaweb/javaweb08/"/>
      <url>/2021/11/18/javaweb/javaweb08/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-实现第一个Filter"><a href="#1-实现第一个Filter" class="headerlink" title="1.实现第一个Filter"></a>1.实现第一个Filter</h2><p>首先在Eclipse中创建一个名为chapter08的Web项目，然后在该项目的src目录下创建一个名为pidan.filter包，<br>最后在该包下创建一个名为MyServlet的Servlet 类，该类用于访问时在浏览器中输出“Hello MyServlet”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyServlet extends HttpServlet &#123;</span><br><span class="line">private static final long serialVersionUID = 1L;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">response.getWriter().print(&quot;hello dashuju2004-------pidan&lt;br /&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">// TODO Auto-generated method stub</span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在web.xml文件中对Servlet进行如下配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">&lt;description&gt;&lt;/description&gt;</span><br><span class="line">&lt;display-name&gt;MyServlet&lt;/display-name&gt;</span><br><span class="line">&lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;servlet-class&gt;pidan.filter.MyServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">&lt;servlet-name&gt;MyServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat 服务器，在浏览器的地址栏中输入地址“<a href="http://localhost:8080/chapterO8/MyServlet%E2%80%9D">http://localhost:8080/chapterO8/MyServlet”</a></p><p>在pidan.filter包中创建一个名为MyFilter的Fiter类，该类用于拦截MyServlet程序。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">response.setContentType(&quot;text/html;charset=utf-8&quot;);</span><br><span class="line">System.out.println(&quot;拦截了原网站的响应&quot;);</span><br><span class="line">response.getWriter().print(&quot;这是filter输出到网页的内容&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>过滤器程序与Servlet程序类似，同样需要在 web.xml文件中进行配置，从而设置它所能拦截的资源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.MyFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><p>在上述代码中，过滤器的配置信息中包含多个元素，这些元素分别具有不同的作用，具体如下。</p><blockquote><p><filter>根元素用于注册一个Filter。<br><filter-name>子元素用于设置Filter名称。<br><filter-class>子元素用于设置Filter类的完整名称。<br><filter-mapping>根元素用于设置一个过滤器所拦截的资源。<br><filter-name>子元素必须与<filter>中的<filter-name>子元素相同。<br><url-pattern>子元素用于匹配用户请求的URL,例如“/MyServlet”，这个URL还可以使用通配符“<em>”来表示，例如“</em>.do”适用于所有以“.do”结尾的Servlet路径。</p></blockquote><p>重新启动Tomcat 服务器，在浏览器访问MyServlet</p><h2 id="2-Filter映射"><a href="#2-Filter映射" class="headerlink" title="2.Filter映射"></a>2.Filter映射</h2><p>2.1拦截不同方式的访问请求<br>    在web.xml文件中，一个<filter-mapping>元素用于配置一个Fiter所负责拦截的资源。<br><filter-mapping>元素中有一个特殊的子元素<dispatcher>,该元素用于指定过滤器所拦截的资源被Servlet容器调用的方式，、<br><dispatcher>元素的值共有4个：</p><blockquote><p>REQUEST<br>当用户直接访问页面时，Web容器将会调用过滤器。如果目标资源是通过RequestDispatcher的include()或 forward()方法访问的，那么该过滤器将不会被调用。<br>INCLUDE<br>如果目标资源是通过RequestDispatcher的 include()方法访问的，那么该过滤器将被调用。<br>除此之外，该过滤器不会被调用。<br>FORWARD<br>如果目标资源是通过RequestDispatcher的forward()方法访问的，那么该过滤器将被调用。<br>除此之外，该过滤器不会被调用。<br>ERROR<br>如果目标资源是通过声明式异常处理机制调用的，那么该过滤器将被调用。除此之外，过滤器不会被调用。</p></blockquote><p>在chapter08项目的pidan.filter包中，<br>创建一个名为ForwardServlet的Servlet类，该类用于将请求转发给first.jsp页面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class ForwardServlet extends HttpServlet &#123;</span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">request.getRequestDispatcher(&quot;/first.jsp&quot;).forward(request,response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在web.xml文件中，配置ForwardServlet信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">&lt;servlet-name&gt;ForwardServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;servlet-class&gt;pidan.filter.ForwardServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">&lt;servlet-name&gt;ForwardServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/ForwardServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure><p>在WebContent目录中创建一个first.jsp页面，该页面用于输出内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">    pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">first.jsp</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>在pidan.filter包中，创建一个过滤器ForwardFiter.java,该过滤器专门用于对first.jsp页面进行拦截</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line">public class ForwardFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">PrintWriter out=response.getWriter();</span><br><span class="line">out.write(&quot;Hello FilterYest&quot;);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在web.xml文件中，配置过滤器的映射信息，拦截first.jsp页面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.ForwardFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/first.jsp&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat 服务器，在浏览器访问ForwardServlet</p><p>浏览器可以正常访问JSP页面，说明ForwardFilter没有拦截到ForwardServlet转发的first.jsp页面。<br>为了拦截ForwardServlet通过forward(）方法转发的first.jsp页面，需要在web.xml文件中的对应过滤器配置信息中增加一个<dispatcher>子元素，将该元素的值设置为FORWARD</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.ForwardFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;ForwardFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/first.jsp&lt;/url-pattern&gt;</span><br><span class="line">&lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><p>浏览器窗口显示的是ForwardFilter类中的内容，而first.jsp页面的输出内容没有显示。<br>由此可见,ForwardServlet中通过 forward()方法转发的 first.jsp页面被成功拦截了。</p><h2 id="3-Filter链"><a href="#3-Filter链" class="headerlink" title="3.Filter链"></a>3.Filter链</h2><p>3.1 在 chapter08 项目的pidan.filter 包中新建两个过滤器 MyFilter01 和MyFilter02</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line">public class MyFilter01 implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">   </span><br><span class="line">public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">PrintWriter out=response.getWriter();</span><br><span class="line">out.write(&quot;Hello MyFilter01&lt;br /&gt;&quot;);</span><br><span class="line">chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pidan.filter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.Filter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterChain;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.FilterConfig;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyFilter02</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">PrintWriter out=response.getWriter();</span><br><span class="line">out.write(<span class="string">&quot;MyFilter02 Before&lt;br /&gt;&quot;</span>);</span><br><span class="line">chain.doFilter(request, response);</span><br><span class="line">out.write(<span class="string">&quot;MyFilter02 After&lt;br /&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig fConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了防止其他过滤器影响此次Filter链的演示效果，请先在web.xml文件中注释掉其他过滤器的配置信息。<br>然后，将MyFilter01和MyFilter02过滤器的映射信息配置在MyServlet配置信息前面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter01&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.MyFilter01&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter01&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter02&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.MyFilter02&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter02&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><p>MyServlet首先被MyFilter01拦截了，打印出MyFilter01中的内容，然后被MyFilter02拦截，<br>直到MyServlet被MyFilterO2放行后，浏览器才显示出MyServlet中的输出内容。 </p><h2 id="4-FilterConfig接口"><a href="#4-FilterConfig接口" class="headerlink" title="4.FilterConfig接口"></a>4.FilterConfig接口</h2><p>在 chapter08项目的pidan.filter包中创建过滤器MyFilter03,来获取 web.xml中设置的参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">public class MyFilter03 implements Filter &#123;</span><br><span class="line">private String characterEncoding;</span><br><span class="line">FilterConfig fc;</span><br><span class="line"> </span><br><span class="line">public void destroy() &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">characterEncoding=fc.getInitParameter(&quot;encoding&quot;);</span><br><span class="line">System.out.println(&quot;encoding 初始化参数的值为：&quot;+characterEncoding);</span><br><span class="line">chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">this.fc=fConfig;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 web.xml文件中配置过滤器信息。由于Filter链中各个Filter的拦截顺序与它们在web.xml文件中<fiter-mapping>元素的映射顺序一致，<br>因此,为了防止其他Filter影响MyFilter03的拦截效果，这里将MyFilter03映射信息配置在web.xml文件最前端</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter03&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.MyFilter03&lt;/filter-class&gt;</span><br><span class="line">&lt;init-param&gt;</span><br><span class="line">&lt;param-name&gt;encoding&lt;/param-name&gt;</span><br><span class="line">&lt;param-value&gt;GBK&lt;/param-value&gt;</span><br><span class="line">&lt;/init-param&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;MyFilter03&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/MyServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure><p>使用Filter获取到了配置文件中的初始化参数。当Tomcat服务器启动时，会加载所有的Web应用，<br>当加载到chapter08这个Web应用时，MyFiter03就会被初始化调用 init()方法，从而可以得到FilterConfig 对象。<br>然后在doFilter()方法中通过调用FilterConfig对象的qetlnitParameter()方法便可以获取在web.xml文件中配置的某个参数信息。</p><h2 id="5-任务——使用Filter实现用户自动登录"><a href="#5-任务——使用Filter实现用户自动登录" class="headerlink" title="5.任务——使用Filter实现用户自动登录"></a>5.任务——使用Filter实现用户自动登录</h2><p>5.1 编写User类<br>   在chapter08项目中创建pidan.entity包，在该包中编写User 类，该类用于封装用户的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">package pidan.entity;</span><br><span class="line"> </span><br><span class="line">public class User &#123;</span><br><span class="line">private String username;</span><br><span class="line">private String password;</span><br><span class="line">public String getUsername() &#123;</span><br><span class="line">return username;</span><br><span class="line">&#125;</span><br><span class="line">public void setUsername(String username) &#123;</span><br><span class="line">this.username = username;</span><br><span class="line">&#125;</span><br><span class="line">public String getPassword() &#123;</span><br><span class="line">return password;</span><br><span class="line">&#125;</span><br><span class="line">public void setPassword(String password) &#123;</span><br><span class="line">this.password = password;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>5.2 实现登录页面和首页<br>(1).在chapter08项目的WebContent根目录中，编写login.jsp页面，该页面用于创建一个用户登录的表单，<br>这个表单需要填写用户名和密码，以及用户自动登录的时间</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">pageEncoding=&quot;utf-8&quot; import=&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;/head&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;h3&gt;用户登录&lt;/h3&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;body style=&quot;text-align: center;&quot;&gt;</span><br><span class="line">&lt;form action=&quot;$&#123;pageContext.request.contextPath &#125;/LoginServlet&quot;</span><br><span class="line">method=&quot;post&quot;&gt;</span><br><span class="line">&lt;table border=&quot;1&quot; width=&quot;600px&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;</span><br><span class="line">align=&quot;center&quot;&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td height=&quot;30&quot; align=&quot;center&quot;&gt;用户名：&lt;/td&gt;</span><br><span class="line">&lt;td&gt;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;text&quot; name=&quot;username&quot; /&gt;$&#123;errorMsg &#125;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td height=&quot;30&quot; align=&quot;center&quot;&gt;密 &amp;nbsp; 码：&lt;/td&gt;</span><br><span class="line">&lt;td&gt;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;password&quot; name=&quot;password&quot; /&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td height=&quot;35&quot; align=&quot;center&quot;&gt;自动登录时间&lt;/td&gt;</span><br><span class="line">&lt;td&gt;&lt;input type=&quot;radio&quot; name=&quot;autologin&quot;</span><br><span class="line">value=&quot;$&#123;60*60*24*31 &#125;&quot; /&gt;一个月 &lt;input type=&quot;radio&quot; name=&quot;autologin&quot;</span><br><span class="line">value=&quot;$&#123;60*60*24*31*3 &#125;&quot; /&gt;三个月 &lt;input type=&quot;radio&quot;</span><br><span class="line">name=&quot;autologin&quot; value=&quot;$&#123;60*60*24*31*6 &#125;&quot; /&gt;半年 &lt;input</span><br><span class="line">type=&quot;radio&quot; name=&quot;autologin&quot; value=&quot;$&#123;60*60*24*31*12 &#125;&quot; /&gt;一年&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td height=&quot;30&quot; colspan=&quot;2&quot; align=&quot;center&quot;&gt;&lt;input type=&quot;submit&quot;</span><br><span class="line">value=&quot;登录&quot; /&gt; &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; &lt;input type=&quot;reset&quot;</span><br><span class="line">value=&quot;重置&quot; /&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;html&gt;</span><br></pre></td></tr></table></figure><p>(2).在chapter08项目的WebContent根目录中，编写index.jsp页面，该页面用于显示用户的登录信息。<br>如果没有用户登录，在index.jsp页面中就显示一个用户登录的超链接。如果用户已经登录，在 index.isp页面中显示登录的用户名，以及一个注销的超链接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">  &lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=utf-8&quot;</span><br><span class="line">pageEncoding=&quot;utf-8&quot; import=&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot;%&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;显示登录的用户信息&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">&lt;h3&gt;欢迎光临&lt;/h3&gt;</span><br><span class="line">&lt;/center&gt;</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;c:choose&gt;</span><br><span class="line">&lt;c:when test=&quot;$&#123;sessionScope.user==null &#125;&quot;&gt;</span><br><span class="line">&lt;a href=&quot;http://localhost:9999/chap08/login.jsp&quot;&gt;用户登录&lt;/a&gt;</span><br><span class="line">&lt;/c:when&gt;</span><br><span class="line">&lt;c:otherwise&gt;</span><br><span class="line">欢迎您：$&#123;sessionScope.user.username&#125;    &lt;a</span><br><span class="line">href=&quot;http://localhost:9999/chap08/LogoutServlet&quot;&gt;退出&lt;/a&gt;</span><br><span class="line">&lt;/c:otherwise&gt;</span><br><span class="line">&lt;/c:choose&gt;</span><br><span class="line">&lt;hr /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>6.创建Servlet<br>(1)编写LoginServlet类<br>在chapter08项目的pidan.filter包中，编写LoginServlet类，该类用于处理用户的登录请求。<br>如果输入的用户名和密码正确，则发送一个用户自动登录的Cookie，并跳转到首页；否则会提示输入的用户名或密码错误，<br>并跳转至登录页面login.jsp让用户重新登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.annotation.WebServlet;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServlet;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line">import javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line">import pidan.entity.User;</span><br><span class="line"> </span><br><span class="line">public class LoginServlet extends HttpServlet &#123;</span><br><span class="line"> </span><br><span class="line">    public LoginServlet() &#123;</span><br><span class="line">        super();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">String username = request.getParameter(&quot;username&quot;);</span><br><span class="line">String password = request.getParameter(&quot;password&quot;);</span><br><span class="line">if (&quot;pidan&quot;.equals(username) &amp;&amp; &quot;666666&quot;.equals(password)) &#123;</span><br><span class="line">User user = new User();</span><br><span class="line">user.setUsername(username);</span><br><span class="line">user.setPassword(password);</span><br><span class="line">request.getSession().setAttribute(&quot;user&quot;, user);</span><br><span class="line">String autoLogin = request.getParameter(&quot;autoLogin&quot;);</span><br><span class="line">if (autoLogin != null) &#123;</span><br><span class="line">Cookie cookie = new Cookie(autoLogin, username + &quot;-&quot;+password);</span><br><span class="line">cookie.setMaxAge(Integer.parseInt(autoLogin));</span><br><span class="line">cookie.setPath(request.getContextPath());</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">&#125;</span><br><span class="line">response.sendRedirect(request.getContextPath()+&quot;/index.jsp&quot;);</span><br><span class="line">&#125;else &#123;</span><br><span class="line">request.setAttribute(&quot;errerMsg&quot;, &quot;用户名或密码错误&quot;);</span><br><span class="line">request.getRequestDispatcher(&quot;/login.jsp&quot;).forward(request, response);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &#123;</span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>7.创建过滤器<br>在chapter08项目的pidan.filter包中，编写AutoLoginFilter类，该类用于拦截用户登录的访问请求，<br>判断请求中是否包含用户自动登录的Cookie。<br>如果包含，则获取Cookie中的用户名和密码，并验证用户名和密码是否正确。如果正确，则将用户的登录信息封装到User对象存入Session域中，完成用户自动登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">package pidan.filter;</span><br><span class="line"> </span><br><span class="line">import java.io.IOException;</span><br><span class="line">import javax.servlet.Filter;</span><br><span class="line">import javax.servlet.FilterChain;</span><br><span class="line">import javax.servlet.FilterConfig;</span><br><span class="line">import javax.servlet.ServletException;</span><br><span class="line">import javax.servlet.ServletRequest;</span><br><span class="line">import javax.servlet.ServletResponse;</span><br><span class="line">import javax.servlet.annotation.WebFilter;</span><br><span class="line">import javax.servlet.http.Cookie;</span><br><span class="line">import javax.servlet.http.HttpServletRequest;</span><br><span class="line"> </span><br><span class="line">import pidan.entity.User;</span><br><span class="line"> </span><br><span class="line">public class AutoLoginFilter implements Filter &#123;</span><br><span class="line"> </span><br><span class="line">public void destroy() &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void doFilter(ServletRequest req, ServletResponse response, FilterChain chain) throws IOException, ServletException &#123;</span><br><span class="line">HttpServletRequest request = (HttpServletRequest) req;</span><br><span class="line">Cookie[] cookies = request.getCookies();</span><br><span class="line">String autologin = null;</span><br><span class="line">for (int i = 0; cookies != null &amp;&amp; i&lt;cookies.length;i++) &#123;</span><br><span class="line">if (&quot;autologin&quot;.equals(cookies[i].getValue())) &#123;</span><br><span class="line">autologin = cookies[i].getValue();</span><br><span class="line">break;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">if (autologin != null) &#123;</span><br><span class="line">String[] parts = autologin.split(&quot;-&quot;);</span><br><span class="line">String username = parts[0];</span><br><span class="line">String password = parts[1];</span><br><span class="line">if (&quot;pidan&quot;.equals(username)&amp;&amp;(&quot;666666&quot;).equals(password)) &#123;</span><br><span class="line">User user = new User();</span><br><span class="line">user.setUsername(username);</span><br><span class="line">user.setPassword(password);</span><br><span class="line">request.getSession().setAttribute(&quot;user&quot;, user);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">chain.doFilter(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">public void init(FilterConfig fConfig) throws ServletException &#123;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>8.配置映射信息<br>    在web.xml文件中，配置所有相关Servlet及AutoLoginFilter过滤器信息。<br>由于要拦截用户访问资源的所有请求，因此，将过滤器<filter-mapping>元素拦截的路径设置为“/”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">&lt;filter-name&gt;AutoLoginFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;filter-class&gt;pidan.filter.AutoLoginFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">&lt;filter-name&gt;AutoLoginFilter&lt;/filter-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">&lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;servlet-class&gt;pidan.filter.LoginServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">&lt;servlet-name&gt;LoginServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/LoginServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br><span class="line">&lt;servlet&gt;</span><br><span class="line">&lt;servlet-name&gt;LogoutServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;servlet-class&gt;pidan.filter.LogouServlet&lt;/servlet-class&gt;</span><br><span class="line">&lt;/servlet&gt;</span><br><span class="line">&lt;servlet-mapping&gt;</span><br><span class="line">&lt;servlet-name&gt;LogoutServlet&lt;/servlet-name&gt;</span><br><span class="line">&lt;url-pattern&gt;/LogoutServlet&lt;/url-pattern&gt;</span><br><span class="line">&lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure><p>9.运行项目，查看结果<br>(1)访问login.jsp页面<br>重启服务器，打开IE浏览器在地址栏中输入“<a href="http://localhost:8888/chapter08/login.jsp%E2%80%9D%EF%BC%8C">http://localhost:8888/chapter08/login.jsp”，</a><br>此时，浏览器窗口中会显示一个用户登录的表单，在这个表单中输入用户名“baixiao”、密码“123456”，并选择用户自动登录的时间<br>(2)实现登录<br>    点击登录按钮，便可完成自动登录<br>(3)注销用户<br>    单击图中的【注销】超链接，就可以注销当前的用户，然后显示index.jsp页面</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaWeb-07 EL表达式和JSTL</title>
      <link href="/2021/11/10/javaweb/javaweb07/"/>
      <url>/2021/11/10/javaweb/javaweb07/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>javaBean<br>在Eclipse中创建一个名为chapterO7的Web项目，然后在项目的src目录下创建包pidan.servlet,<br>在包中创建一个用于存储用户名和密码的类MyServlet</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> pidan.servlet;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.RequestDispatcher;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Servlet implementation class MyServlet</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/MyServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">request.setAttribute(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;dashuju&quot;</span>);</span><br><span class="line"></span><br><span class="line">request.setAttribute(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line"></span><br><span class="line">RequestDispatcher dis=request.getRequestDispatcher(<span class="string">&quot;/myjsp.jsp&quot;</span>);</span><br><span class="line">dis.forward(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;****</span><br></pre></td></tr></table></figure><p>然后，在WebContent目录下编写一个名为myjsp的JSP文件，使用该文件来输出MyServlet所存储的信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">**&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%=(String) request.getAttribute(<span class="string">&quot;username&quot;</span>) %&gt;&lt;br/&gt;</span><br><span class="line">&lt;%=(String) request.getAttribute(<span class="string">&quot;password&quot;</span>) %&gt;&lt;br/&gt;</span><br><span class="line"></span><br><span class="line">&lt;hr/&gt;</span><br><span class="line">使用EL表达式：&lt;br /&gt;</span><br><span class="line">$&#123;username&#125;&lt;br /&gt;</span><br><span class="line">$&#123;password&#125;&lt;br /&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;**</span><br></pre></td></tr></table></figure><p>最后，部署Web项目chapter07,启动Tomcat 服务器，在浏览器访问MyServlet页面</p><p>在项目的WebContent目录下，新建一个名为scopes.jsp的文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;% pageContext.setAttribute(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;HYS&quot;</span>); %&gt;</span><br><span class="line">&lt;% request.setAttribute(<span class="string">&quot;bookName&quot;</span>,<span class="string">&quot;dashuju2004&quot;</span>); %&gt;</span><br><span class="line">&lt;% session.setAttribute(<span class="string">&quot;userName&quot;</span>,<span class="string">&quot;Java Web&quot;</span>); %&gt;</span><br><span class="line">&lt;% application.setAttribute(<span class="string">&quot;bookName&quot;</span>, <span class="string">&quot;Java 基础&quot;</span>); %&gt;</span><br><span class="line">$&#123;pageScope.userName &#125;&lt;br /&gt;</span><br><span class="line">$&#123;requestScope.bookName &#125;&lt;br /&gt;</span><br><span class="line">$&#123;sessionScope.userName &#125;&lt;br /&gt;</span><br><span class="line">$&#123;applicationScope.bookName &#125;&lt;br /&gt;</span><br><span class="line">$&#123;userName &#125;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat 服务 器， 在浏览器访问scopes.jsp页面<br>在项目的WebContent目录下，新建一个名为param.jsp的文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/param.jsp&quot;</span>&gt;</span><br><span class="line">num1: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;num1&quot;</span>&gt;&lt;br /&gt;</span><br><span class="line">num2: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;num&quot;</span>&gt;&lt;br /&gt;</span><br><span class="line">num3: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;num&quot;</span>&gt;&lt;br /&gt; &lt;br /&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span>value=<span class="string">&quot;提交&quot;</span>/&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span>value=<span class="string">&quot;重置&quot;</span>/&gt;&lt;hr/&gt;</span><br><span class="line">num1: $&#123;param.num1&#125;&lt;br /&gt;</span><br><span class="line">num2: $&#123;paramValues.num[<span class="number">0</span>]&#125;&lt;br /&gt;</span><br><span class="line">num3: $&#123;paramValues.num[<span class="number">1</span>]&#125;&lt;br /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat 服务器，在浏览器访问param.jsp页面，浏览器窗口中会显示一个表单，在这个表单中输入3个数字，分别为10、20、30，然后单击【提交】按钮</p><p>在项目的WebContent目录下，新建一个名为cookie.jsp的文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;% response.addCookie(<span class="keyword">new</span> Cookie(<span class="string">&quot;uesrName&quot;</span>,<span class="string">&quot;pidan&quot;</span>)); %&gt;</span><br><span class="line">Cookie对象的信息：&lt;br /&gt;</span><br><span class="line">$&#123;cookie.userName &#125;&lt;br /&gt;</span><br><span class="line">Cookie对象的名称和值：&lt;br /&gt;</span><br><span class="line">$&#123;cookie.userName.name &#125;=$&#123;cookie.userName.value &#125;</span><br><span class="line"> </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;**</span><br></pre></td></tr></table></figure><p>启动Tomcat服务器，在浏览器访问cookie.jsp页面，由于是浏览器第1次访问cookie.jsp页面，<br>此时，服务器还没有接收到名为userName的Cookie信息，因此，浏览器窗口中不会显示 。<br>接下来刷新浏览器， 第2次访问cookie.jsp页面</p><p>在chapterO7项目的WebContent目录下创建一个名为c_out1.jsp的文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%--第<span class="number">1</span>个out标签--%&gt;</span><br><span class="line">userName属性的值为：</span><br><span class="line">&lt;c:out value=<span class="string">&quot;$&#123;param.username&#125;&quot;</span> <span class="keyword">default</span>=<span class="string">&quot;unknown&quot;</span>/&gt;&lt;br /&gt;</span><br><span class="line">&lt;%--第<span class="number">2</span>个out标签--%&gt;</span><br><span class="line">userName属性的值为：</span><br><span class="line">&lt;c:out value=<span class="string">&quot;$&#123;param.username&#125;&quot;</span>&gt;</span><br><span class="line">unknown</span><br><span class="line">&lt;/c:out&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;****</span><br></pre></td></tr></table></figure><h2 id="lt-c-forEach-gt-标签"><a href="#lt-c-forEach-gt-标签" class="headerlink" title="&lt;c:forEach&gt;标签"></a>&lt;c:forEach&gt;标签</h2><blockquote><p>var属性用于指定将当前迭代到的元素保存到page域中的名称。<br>items属性用于指定将要迭代的集合对象。<br>varStatus属性用于指定当前迭代状态信息的对象保存到page域中的名称。<br>begin属性用于指定从集合中第几个元素开始进行迭代，begin的索引值从0开始。如果没有指定items属性，就从begin指定的值开始迭代，直到迭代结束为止。<br>step属性用于指定迭代的步长，即迭代因子的增量。</p></blockquote><p>在项目的WebContent目录下，创建一个名为c_foreach1.jsp的文件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">**&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">String[] fruits =&#123;<span class="string">&quot;apple&quot;</span>,<span class="string">&quot;orange&quot;</span>,<span class="string">&quot;grape&quot;</span>,<span class="string">&quot;banana&quot;</span>&#125;;</span><br><span class="line">request.setAttribute(<span class="string">&quot;ff&quot;</span>, fruits);</span><br><span class="line">%&gt;</span><br><span class="line">String数组中的元素：</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;name&quot;</span> items=<span class="string">&quot;&lt;%=fruits %&gt;&quot;</span>&gt;</span><br><span class="line">$&#123;name&#125;&lt;br /&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br><span class="line">&lt;%</span><br><span class="line">Map userMap = <span class="keyword">new</span> HashMap();</span><br><span class="line">userMap.put(<span class="string">&quot;Tom&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">userMap.put(<span class="string">&quot;Make&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">userMap.put(<span class="string">&quot;Lina&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line">request.setAttribute(<span class="string">&quot;map&quot;</span>, userMap);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;hr /&gt;</span><br><span class="line">HashMap集合中的元素：</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;entry&quot;</span> items=<span class="string">&quot;&lt;%=userMap %&gt;&quot;</span>&gt;</span><br><span class="line">key:$&#123;entry.key&#125;-------$&#123;entry.value&#125;&lt;br /&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;**</span><br></pre></td></tr></table></figure><p>启动Tomcat服务器，在浏览器访问c_foreach1.jsp页面<br><img src="./img/2.png"><br>在项目的WebContent目录下，创建一个名为c_foreach2.jsp的文件，该文件中使用了<br>&lt;c:forEach&gt;标签的begin、end和step属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">pageEncoding=<span class="string">&quot;UTF-8&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*&quot;</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> prefix=<span class="string">&quot;c&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">colorsList集合(指定迭代范围和步长)</span><br><span class="line">&lt;br /&gt;</span><br><span class="line">&lt;% List colorsList=<span class="keyword">new</span> ArrayList();</span><br><span class="line">colorsList.add(<span class="string">&quot;red&quot;</span>);</span><br><span class="line">colorsList.add(<span class="string">&quot;yellow&quot;</span>);</span><br><span class="line">colorsList.add(<span class="string">&quot;blue&quot;</span>);</span><br><span class="line">colorsList.add(<span class="string">&quot;green&quot;</span>);</span><br><span class="line">colorsList.add(<span class="string">&quot;black&quot;</span>);</span><br><span class="line">colorsList.add(<span class="string">&quot;gray&quot;</span>);</span><br><span class="line">request.setAttribute(<span class="string">&quot;list&quot;</span>, colorsList);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;aa&quot;</span> items=<span class="string">&quot;$&#123;list &#125;&quot;</span> begin=<span class="string">&quot;0&quot;</span> end=<span class="string">&quot;5&quot;</span> step=<span class="string">&quot;2&quot;</span>&gt;</span><br><span class="line">$&#123;aa&#125;&amp;nbsp;</span><br><span class="line">&lt;/c:forEach&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>&lt;c:forEach&gt;标签的varStatus属性用于设置一个javax.servlet.jsp.jstl.core.LoopTagStatus类型的变量，这个变量包含了从集合中取出元素的状态信息。使用&lt;c:forEach&gt;标签的varStatus属性可以获取以下信息。</p><blockquote><p>count：表示元素在集合中的序号，从1开始计数。<br>index：表示当前元素在集合中的索引，从0开始计数。<br>first：表示当前是否为集合中的第1个元素。<br>last：表示当前是否为集合中的最后一个元素。</p></blockquote><p>在项目的WebContent目录下，创建一个名为c_foreach3.jsp的文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">pageEncoding=&quot;UTF-8&quot; import=&quot;java.util.*&quot;%&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body style=&quot;text-align: center&quot;&gt;</span><br><span class="line">&lt;%</span><br><span class="line">List userList = new ArrayList();</span><br><span class="line">userList.add(&quot;Tom&quot;);</span><br><span class="line">userList.add(&quot;Make&quot;);</span><br><span class="line">userList.add(&quot;Lina&quot;);</span><br><span class="line">request.setAttribute(&quot;users&quot;,userList);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;table border=&quot;1&quot;&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;序号&lt;/td&gt;</span><br><span class="line">&lt;td&gt;索引&lt;/td&gt;</span><br><span class="line">&lt;td&gt;是否为第一个索引&lt;/td&gt;</span><br><span class="line">&lt;td&gt;是否为最后一个索引&lt;/td&gt;</span><br><span class="line">&lt;td&gt;元素的值&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;!-- varStatus属性 --&gt;</span><br><span class="line">&lt;c:forEach var=&quot;bb&quot; items=&quot;$&#123;users &#125;&quot; varStatus=&quot;vv&quot;&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;$&#123;vv.count&#125;&lt;/td&gt;</span><br><span class="line">&lt;td&gt;$&#123;vv.index&#125;&lt;/td&gt;</span><br><span class="line">&lt;td&gt;$&#123;vv.first &#125;&lt;/td&gt;</span><br><span class="line">&lt;td&gt;$&#123;vv.last &#125;&lt;/td&gt;</span><br><span class="line">&lt;td&gt;$&#123;bb &#125;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/c:forEach&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>&lt;c:url&gt;标签</p><blockquote><p>value属性用于指定构造的URL。<br>context属性用于指定导入同一个服务器下其他Web应用的名称。<br>var属性用于指定将构造的URL地址保存到域对象的属性名称。<br>scope属性用于指定将构造好的URL保存到域对象中。</p></blockquote><p>在项目的WebContent目录下新建一个名为c_url.jsp的文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;</span><br><span class="line">pageEncoding=&quot;UTF-8&quot;%&gt;</span><br><span class="line">&lt;%@ taglib uri=&quot;http://java.sun.com/jsp/jstl/core&quot; prefix=&quot;c&quot;%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">使用绝对路径构造URL:&lt;br /&gt;</span><br><span class="line">&lt;c:url var=&quot;absoulateURL&quot; value=&quot;http://localhost:8888/chapter07/login.html&quot;&gt;</span><br><span class="line">&lt;c:param name=&quot;username&quot; value=&quot;张三&quot;&gt;&lt;/c:param&gt;</span><br><span class="line">&lt;c:param name=&quot;country&quot; value=&quot;中国&quot;&gt;&lt;/c:param&gt;</span><br><span class="line">&lt;/c:url&gt;</span><br><span class="line">&lt;a href=&quot;$&#123;absoulateURL &#125;&quot;&gt;绝对路径登录页面&lt;/a&gt;</span><br><span class="line">&lt;hr /&gt;</span><br><span class="line">使用相对路径:&lt;br /&gt;</span><br><span class="line">&lt;c:url var=&quot;risistURL&quot; value=&quot;login.html?username=张三&amp;country=中国&quot;&gt;&lt;/c:url&gt;</span><br><span class="line">&lt;a href=&quot;$&#123;risistURL &#125;&quot;&gt;相对路径登录页面&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>本章主要讲解了JavaBean、BeanUtils工具、EL表达式的基本语法、常见EL表达式隐式对象、JSTL的下载和使用以及JSTL常见标签库等知识。<br>通过本章的学习，读者能够了解什么是JavaBean,什么是EL表达式和JSTL,可以熟练地掌握通过BeanUtils工具访问JavaBean、EL表达式的基本语法的格式、<br>EL的常见隐式对象以及JSTL中的常见Core标签库等操作。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaWeb-06 JSP技术</title>
      <link href="/2021/11/09/javaweb/javaweb06/"/>
      <url>/2021/11/09/javaweb/javaweb06/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1-什么是jsp"><a href="#1-什么是jsp" class="headerlink" title="1.什么是jsp"></a>1.什么是jsp</h2><p>JSP全名是Java Server Pages,它是建立在Servlet规范之上的动态网页开发技术;</p><h2 id="2-jsp基本语法"><a href="#2-jsp基本语法" class="headerlink" title="2.jsp基本语法"></a>2.jsp基本语法</h2><p>JSP全名是Java Server Pages,它是建立在Servlet规范之上的动态网页开发技术;</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">   定义变量或方法</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>在chaptero6项目的WebContent目录下创建一个名称为example01.jsp的文件，在该文件中编写声明语句</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;%!</span><br><span class="line"><span class="keyword">int</span> a=<span class="number">1</span> ,b=<span class="number">2</span>;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%!</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line">String str = <span class="string">&quot;pidan&quot;</span>;</span><br><span class="line"><span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(a+b);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(print());</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat并在浏览器访问example01.jsp文件<br>JSP表达式（expression）用于将程序数据输出到客户端，它将要输出的变量或者表达式直接封装在以“&lt;%=”开头和以“%&gt;”结尾的标记中，其基本的语法格式</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=a+b %&gt;&lt;br/&gt;</span><br><span class="line">&lt;%=print() %&gt;</span><br></pre></td></tr></table></figure><p>jsp注释<br>同其他各种编程语言一样，JSP也有自己的注释方式，其基本语法格式<br><code>java  &lt;%--注释信息--%&gt;</code><br>在chapterO6项目的WebContent目录下创建一个名称为example02的JSP页面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- 这是一个HTML注释 --&gt;</span><br><span class="line">&lt;%--这是一个JSP注释 --%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>启动Tomcat并在浏览器访问example02.jsp文件，按F12查看源文件</p><h2 id="jsp指令"><a href="#jsp指令" class="headerlink" title="jsp指令"></a>jsp指令</h2><p>1.include指令<br>在chapterO6项目的WebContent目录下<br>创建两个JSP页面文件date.jsp和include.jsp,在clude.jsp文件中使用 include指令将date.jsp文件包含其中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(<span class="keyword">new</span> java.util.Date().toLocaleString());</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;欢迎你&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">欢迎你pidan，现在的时间是：</span><br><span class="line">&lt;%@</span><br><span class="line">include file=<span class="string">&quot;date.jsp&quot;</span></span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat并在浏览器访问include.jsp文件<br><img src="https://cdn.jsdelivr.net/gh/string32/picgo/img/3CA758D67DDFBEC2A1FF312E7C80054F.JPG"></p><p>2.jsp隐式对象<br>在chapterO6项目的WebContent目录下创建一个名称为out.jsp页面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span></span><br><span class="line"> buffer=<span class="string">&quot;0kb&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">out.println(<span class="string">&quot;first line&lt;br /&gt;&quot;</span>);</span><br><span class="line">response.getWriter().println(<span class="string">&quot;sercond line&lt;br /&gt;&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>启动Tomcat并在浏览器访问out.jsp文件</p><p>在chapterO6项目的WebContent目录下创建一个名称为pageContext.jsp页面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=utf-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">HttpServletRequest req=(HttpServletRequest)pageContext.getRequest();</span><br><span class="line"></span><br><span class="line">pageContext.setAttribute(<span class="string">&quot;req11&quot;</span>,<span class="string">&quot;pageContext&quot;</span>,pageContext.PAGE_SCOPE);</span><br><span class="line">pageContext.setAttribute(<span class="string">&quot;req22&quot;</span>,<span class="string">&quot;dashuju&quot;</span>,pageContext.REQUEST_SCOPE);</span><br><span class="line">pageContext.setAttribute(<span class="string">&quot;req33&quot;</span>,<span class="string">&quot;session&quot;</span>,pageContext.SESSION_SCOPE);</span><br><span class="line">pageContext.setAttribute(<span class="string">&quot;req&quot;</span>,<span class="string">&quot;application&quot;</span>,pageContext.APPLICATION_SCOPE);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%=pageContext.findAttribute(<span class="string">&quot;req&quot;</span>) %&gt;</span><br><span class="line">&lt;hr /&gt;</span><br><span class="line">&lt;%=(String)req.getAttribute(<span class="string">&quot;req22&quot;</span>) %&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>启动Tomcat并在浏览器访问pageContext.jsp文件</p><p>在chapterO6项目的WebContent目录下创建一个名称为exception.jsp的页面，在其中编发生异常的代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span> errorPage=<span class="string">&quot;error.jsp&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line"><span class="keyword">int</span> a=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> b=<span class="number">0</span>;</span><br><span class="line">%&gt;</span><br><span class="line">输出：&lt;%=a/b %&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>在WebContent目录下创建一个名称为error.jsp的页面，<br>在其中获取从exception.jsp页面中传递过来的exception对象。在其page指令中要将 isErrorPage属性设置为true</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span> isErrorPage=<span class="string">&quot;true&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">输出异常信息：&lt;%=exception.getMessage() %&gt;</span><br><span class="line">&lt;br/&gt;&lt;br/&gt;</span><br><span class="line">2020080604029HYS</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>3.动作元素<br>（1）在chapterO6项目的WebContent目录下编写两个JSP文件，分别是included.jsp和dinclude.jsp。<br>其中，dinclude.jsp 页面用于引入 included.jsp 页面。included.jsp作为被引入的文件，让它暂停5秒钟后才输出内容，这样，可以方便测试<a href="jsp:include">jsp:include</a>标签的flush属性。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%Thread.sleep(<span class="number">5000</span>); %&gt;</span><br><span class="line">included 被包含的页面</span><br><span class="line"> </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">dinclude页面用来包含其他页面</span><br><span class="line">&lt;br/&gt;</span><br><span class="line">&lt;jsp:include page=<span class="string">&quot;included.jsp&quot;</span> flush=<span class="string">&quot;true&quot;</span>&gt;&lt;/jsp:include&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>编写一个用于实现转发功能的 jspforward.jsp页面和一个用于显示当前时间的welcome.jsp页面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">转发到其他页面：</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;welcome.jsp&quot;</span>&gt;&lt;/jsp:forward&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">我是welcome文件</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="2-阶段案例：传智书城JSP页面"><a href="#2-阶段案例：传智书城JSP页面" class="headerlink" title="2.阶段案例：传智书城JSP页面"></a>2.阶段案例：传智书城JSP页面</h2><p>在chapter06项目的WebContent目录下创建一个名称为index.jsp的页面文件，该文件使<br>jsp:forword&gt;动作元素跳转到项目客户端展示的首页，其主要代码<br><code>&lt;jsp:forward page=&quot;/client/index.jsp&quot;&gt;&lt;/jsp:forward&gt;</code><br>将第1章中传智书城案例中的client文件夹复制到WebContent目录下，并将client文件夹下的所有.html文件改为.jsp文件</p><p>如果此时运行项目，并访问“<a href="http://localhost:8080/chapter06/client/index.jsp%E2%80%9D%EF%BC%8C%E4%BC%9A%E5%8F%91%E7%8E%B0%E9%A1%B5%E9%9D%A2%E4%B8%AD%E7%9A%84%E4%B8%AD%E6%96%87%E9%83%BD%E6%98%AF%E4%B9%B1%E7%A0%81%E3%80%82%E9%9C%80%E8%A6%81%E5%B0%86%E6%AF%8F%E4%B8%80%E4%B8%AAJSP%E6%96%87%E4%BB%B6%E4%B8%AD%E9%83%BD%E5%8A%A0%E4%B8%8Apage%E6%8C%87%E4%BB%A4">http://localhost:8080/chapter06/client/index.jsp”，会发现页面中的中文都是乱码。需要将每一个JSP文件中都加上page指令</a></p><figure class="highlight plaintext"><figcaption><span>page language</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pageEncoding=&quot;UTF-8&quot;%&gt;</span><br></pre></td></tr></table></figure><p>此时当点击“新用户注册”链接后，所访问的链接路径是/chapternfregister.jsp,而项目中注册页面的真实路径是/chapter06/client/register.jsp,所以出现了“404错误。要解决此问题，只需在index.jsp页面文件中的链接和图片等路径前，加入“${pageContext.request.contextPath}/client/” </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/register.jsp&quot;</span>&gt;新用户注册&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>在client文件夹下创建一个名称为head.jsp的文件，将传智书城 index.jsp中顶部的代码抽取出到head.jsp中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;divhead&quot;</span>&gt;</span><br><span class="line">&lt;table cellspacing=<span class="string">&quot;0&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;headtable&quot;</span>&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/client/images/logo.png&quot;</span> width=<span class="string">&quot;200&quot;</span> height=<span class="string">&quot;60&quot;</span> border=<span class="string">&quot;0&quot;</span> /&gt; </span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;td style=<span class="string">&quot;text-align:right&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/client/images/cart.gif&quot;</span> width=<span class="string">&quot;26&quot;</span> height=<span class="string">&quot;23&quot;</span> style=<span class="string">&quot;margin-bottom:-4px&quot;</span> /&gt;&amp;nbsp;&lt;a href=<span class="string">&quot;#&quot;</span>&gt;购物车&lt;/a&gt; </span><br><span class="line">| &lt;a href=<span class="string">&quot;#&quot;</span>&gt;帮助中心&lt;/a&gt; </span><br><span class="line">| &lt;a href=<span class="string">&quot;#&quot;</span>&gt;我的帐户&lt;/a&gt;</span><br><span class="line">| &lt;a href=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/client/register.jsp&quot;</span>&gt;新用户注册&lt;/a&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>在client文件夹下创建一个名称为menu_search.jsp的文件，将传智书城index.jsp中菜单列表中的代码抽取出到menu_search.jsp中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;divmenu&quot;</span>&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;文学&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;生活&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;计算机&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;外语&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;经管&lt;/a&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;励志&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;社科&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;学术&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;少儿&lt;/a&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;艺术&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;原版&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;科技&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;考试&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;生活百科&lt;/a&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span> style=<span class="string">&quot;color:#FFFF00&quot;</span>&gt;全部商品目录&lt;/a&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;divsearch&quot;</span>&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;#&quot;</span> id=<span class="string">&quot;searchform&quot;</span>&gt;</span><br><span class="line">&lt;table width=<span class="string">&quot;100%&quot;</span> border=<span class="string">&quot;0&quot;</span> cellspacing=<span class="string">&quot;0&quot;</span>&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td style=<span class="string">&quot;text-align:right; padding-right:220px&quot;</span>&gt;</span><br><span class="line">Search </span><br><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;textfield&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;inputtable&quot;</span> id=<span class="string">&quot;textfield&quot;</span> value=<span class="string">&quot;请输入书名&quot;</span></span><br><span class="line">onmouseover=<span class="string">&quot;this.focus();&quot;</span></span><br><span class="line">onclick=<span class="string">&quot;my_click(this, &#x27;textfield&#x27;);&quot;</span></span><br><span class="line">onBlur=<span class="string">&quot;my_blur(this, &#x27;textfield&#x27;);&quot;</span>/&gt; </span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/client/images/serchbutton.gif&quot;</span> border=<span class="string">&quot;0&quot;</span> style=<span class="string">&quot;margin-bottom:-4px&quot;</span> onclick=<span class="string">&quot;search()&quot;</span>/&gt; </span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>在client文件夹下创建一个名称为foot.jsp的文件，将传智书城 index.jsp中底部的代码抽取出到foot.jsp中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%@ page language=<span class="string">&quot;java&quot;</span> contentType=<span class="string">&quot;text/html; charset=UTF-8&quot;</span></span><br><span class="line">    pageEncoding=<span class="string">&quot;UTF-8&quot;</span>%&gt;</span><br><span class="line">&lt;div id=<span class="string">&quot;divfoot&quot;</span>&gt;</span><br><span class="line">&lt;table width=<span class="string">&quot;100%&quot;</span> border=<span class="string">&quot;0&quot;</span> cellspacing=<span class="string">&quot;0&quot;</span> &gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td rowspan=<span class="string">&quot;2&quot;</span> style=<span class="string">&quot;width:10%&quot;</span>&gt;</span><br><span class="line">&lt;img src=<span class="string">&quot;$&#123;pageContext.request.contextPath&#125;/client/images/logo.png&quot;</span> width=<span class="string">&quot;195&quot;</span> height=<span class="string">&quot;50&quot;</span></span><br><span class="line">style=<span class="string">&quot;margin-left:175px&quot;</span> /&gt;</span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;td style=<span class="string">&quot;padding-top:5px; padding-left:50px&quot;</span>&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;#&quot;</span>&gt;</span><br><span class="line">&lt;font color=<span class="string">&quot;#747556&quot;</span>&gt;&lt;b&gt;CONTACT US&lt;/b&gt;&lt;/font&gt; </span><br><span class="line">&lt;/a&gt;</span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td style=<span class="string">&quot;padding-left:50px&quot;</span>&gt;</span><br><span class="line">&lt;font color=<span class="string">&quot;#CCCCCC&quot;</span>&gt;</span><br><span class="line">&lt;b&gt;COPYRIGHT <span class="number">2015</span> &amp;copy; BookStore All Rights RESERVED.&lt;/b&gt; </span><br><span class="line">&lt;/font&gt;</span><br><span class="line">&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>使用include指令将抽取出的3个JSP页面包含在index.jsp中。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Markdown教程</title>
      <link href="/2021/11/06/Markdown%E5%AD%A6%E4%B9%A0/Markdown%E6%95%99%E7%A8%8B/"/>
      <url>/2021/11/06/Markdown%E5%AD%A6%E4%B9%A0/Markdown%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Markdown-教程"><a href="#Markdown-教程" class="headerlink" title="Markdown 教程"></a>Markdown 教程</h1><h2 id="1-使用-和-标记一级和二级biaot"><a href="#1-使用-和-标记一级和二级biaot" class="headerlink" title="1.使用=和-标记一级和二级biaot"></a>1.使用=和-标记一级和二级biaot</h2><h2 id="2-使用-号标记1-6级"><a href="#2-使用-号标记1-6级" class="headerlink" title="2.使用#号标记1-6级"></a>2.使用#号标记1-6级</h2><p>  #一级<br>  ##二级<br>  ###三级<br>  ####四级</p><h2 id="3-字体"><a href="#3-字体" class="headerlink" title="3.字体 "></a>3.字体 </h2><p><strong>加粗</strong></p><p><em>倾斜</em><br><em><strong>加粗加倾斜</strong></em><br>==高亮==<br>我是^上标^<br><del>下标</del>    (注意英文状态下)<br>分隔线  (你可以在一行中用三个以上的星号、减号、底线来建立一个分隔线，行内不能有其他东西。你也可以在星号或是减号中间插入空格。下面每种写法都可以建立分隔线)</p><hr><p>下划线 <u>下划线</u><br>脚注：对文本的补充   [^要注明的文本]</p><h2 id="4-列表"><a href="#4-列表" class="headerlink" title="4.列表"></a>4.列表</h2><p>1.无序列表使用星号(*)、加号(+)或是减号(-)作为列表标记，这些标记后面要添加一个空格，然后再填写内容</p><p>*第一项  #+ -<br>*第二项<br>*第三项</p><p>有序列表（数字并加上 . 号）</p><p>1.第一<br>2.第二<br>3.第三</p><p>列表嵌套<br>列表嵌套只需在子列表中的选项前面添加四个空格即可：<br>1.第一项<br>    嵌套第一个<br>    第二个</p><h2 id="区块引用"><a href="#区块引用" class="headerlink" title="区块引用"></a>区块引用</h2><p>###1.Markdown 区块引用是在段落开头使用 &gt; 符号 ，然后后面紧跟一个空格符号：</p><blockquote><p>我是张三</p><blockquote><p>我是李四</p><blockquote><p>我是王五</p></blockquote></blockquote></blockquote><h2 id="区块中使用列表"><a href="#区块中使用列表" class="headerlink" title="区块中使用列表"></a>区块中使用列表</h2><p>###1。区块中使用列表实例如下</p><blockquote><p>区块中使用实例<br>1.第一项<br>+s<br>2.第二项<br>+第一项</p></blockquote><h2 id="列表中使用区块"><a href="#列表中使用区块" class="headerlink" title="列表中使用区块"></a>列表中使用区块</h2><p>###1.如果要在列表项目内放进区块，那么就需要在 &gt; 前添加四个空格的缩进。<br>*第一项<br>    &gt;markdown教程<br>    &gt;学习使我进步<br>*第二项</p><h2 id="代码块"><a href="#代码块" class="headerlink" title=" 代码块 "></a> 代码块 </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><p><img src="https://cdn.jsdelivr.net/gh/string32/picgo/img/20211106150916.png" alt="链接"><br><img src="https://cdn.jsdelivr.net/gh/string32/picgo/img/20211106151120.png" alt="高级链接"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>JavaWeb-05 会话及其会话技术</title>
      <link href="/2021/11/06/javaweb/javaweb05/"/>
      <url>/2021/11/06/javaweb/javaweb05/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="JavaWeb-05-会话及其会话技术"><a href="#JavaWeb-05-会话及其会话技术" class="headerlink" title="JavaWeb-05 会话及其会话技术"></a>JavaWeb-05 会话及其会话技术</h1><h2 id="实例：显示用户上次访问时间"><a href="#实例：显示用户上次访问时间" class="headerlink" title="实例：显示用户上次访问时间"></a>实例：显示用户上次访问时间</h2><p>###1.创建Servlet<br>在Eclipse中新建Web项目chapter05,并在该项目下新建一个名称为pidan.cookie.example的包，在该包中编写一个名称为LastAccessServlet的Servlet类，用于实现获取 Cookie信息并将当前时间作为Cookie 值发送给客户端。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.cookie.example;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Servlet implementation class LastAccessServlet</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/LastAccessServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LastAccessServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"></span><br><span class="line">Cookie[] cookies=request.getCookies();</span><br><span class="line"></span><br><span class="line">String lastTime=<span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;cookies!=<span class="keyword">null</span>&amp;&amp;i&lt;cookies.length;i++) &#123;</span><br><span class="line">String name=cookies[i].getName();</span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;lastccess&quot;</span>.equals(name)) &#123;</span><br><span class="line">lastTime=cookies[i].getValue();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(lastTime==<span class="keyword">null</span>) &#123;</span><br><span class="line">response.getWriter().print(<span class="string">&quot;第一次访问本网站！&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">response.getWriter().print(<span class="string">&quot;上次访问的时间是：&quot;</span>+lastTime);</span><br><span class="line">response.getWriter().print(<span class="string">&quot;学号：2020080604029&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">String time=String.format(<span class="string">&quot;%tF%&lt;tT&quot;</span>, <span class="keyword">new</span> Date());</span><br><span class="line">Cookie cookie=<span class="keyword">new</span> Cookie(<span class="string">&quot;lastccess&quot;</span>, time);</span><br><span class="line">Cookie cookie1 = <span class="keyword">new</span> Cookie(<span class="string">&quot;dashuju&quot;</span>, <span class="string">&quot;2004&quot;</span>);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">response.addCookie(cookie1);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于这里直接通过 @WebServlet 标签配置URL映射,不再需要从 web.xml 里面配置 servlet。</p><p>启动Tomcat 服务器，在浏览器的地址栏中输入 localhost:8080/chapter05/LastAccessServlet”访问 LastAccessServlet,由于是第一次访问LastAccessServlet：</p><p>重新访问地址（刷新页面）：<br><img src="https://cdn.jsdelivr.net/gh/string32/picgo/img/2.png"></p><h2 id="实例：实现购物车"><a href="#实例：实现购物车" class="headerlink" title="实例：实现购物车"></a>实例：实现购物车</h2><p>1.新建一个名称为pidan.session.example01的包,在该包中创建一个名称为Book的类，该类用于封装图书的信息，<br>其中定义了id和name属性，分别用来表示书的编号和名称。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example01;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String id;</span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(String id, String name)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.id = id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###2.在pidan.session.example01包中创建一个名称为BookDB的类，该类用于模拟保存所有图书的数据库。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example01;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedHashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BookDB</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Book&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;String,Book&gt;();</span><br><span class="line"><span class="keyword">static</span>&#123;</span><br><span class="line">map.put(<span class="string">&quot;1&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;javaWeb&quot;</span>));</span><br><span class="line">map.put(<span class="string">&quot;2&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;jdbc入门&quot;</span>));</span><br><span class="line">map.put(<span class="string">&quot;3&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;java基础&quot;</span>));</span><br><span class="line">map.put(<span class="string">&quot;4&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;4&quot;</span>,<span class="string">&quot;struts框架&quot;</span>));</span><br><span class="line">map.put(<span class="string">&quot;5&quot;</span>, <span class="keyword">new</span> Book(<span class="string">&quot;5&quot;</span>,<span class="string">&quot;hibernate框架&quot;</span>));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//1.得到所有图书</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Collection&lt;Book&gt; <span class="title">getAll</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> map.values();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.根据map的key，也就是图书的id,得到某本图书</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Book <span class="title">getBook</span><span class="params">(String id)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> map.get(id);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###3.创建一个名称为ListBookServlet的Servlet类，<br>该Servlet用于显示所有可购买图书的列表，通过单击“购买”链接，便可将指定的图书添加到购物车中。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example01;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Servlet implementation class BookDB</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@WebServlet(&quot;/ListBookServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ListBookServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="comment">//1,</span></span><br><span class="line">Collection &lt;Book&gt; books= BookDB.getAll();</span><br><span class="line"></span><br><span class="line">PrintWriter out=response.getWriter();</span><br><span class="line"></span><br><span class="line">out.print(<span class="string">&quot;本网站售卖的书籍：&quot;</span>+<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(Book b:books) &#123;</span><br><span class="line">String name= b.getName();</span><br><span class="line">String id=b.getId();</span><br><span class="line">String url=<span class="string">&quot;&lt;a href=&#x27;purcharse?id=&quot;</span>+id+<span class="string">&quot;&#x27;&gt;点击购买&lt;/a&gt;&quot;</span>;</span><br><span class="line">out.print(<span class="string">&quot;图书名称： &quot;</span>+name+<span class="string">&quot;  &quot;</span>+url+<span class="string">&quot;&lt;br/&gt;&lt;br/&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@see</span> HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###4.创建一个名称为PurchaseServlet的Servlet类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example01;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@WebServlet(&quot;/purcharse&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">purcharseServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">String id=request.getParameter(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;id :&quot;</span>+id);</span><br><span class="line"><span class="keyword">if</span>(id==<span class="keyword">null</span>) &#123;</span><br><span class="line">response.sendRedirect(<span class="string">&quot;list&quot;</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">Book book=BookDB.getBook(id);</span><br><span class="line">HttpSession session=request.getSession();<span class="comment">//获得内存区域</span></span><br><span class="line">List&lt;Book&gt; list=(List&lt;Book&gt;)session.getAttribute(<span class="string">&quot;cart&quot;</span>);<span class="comment">//获得购物车</span></span><br><span class="line"><span class="keyword">if</span>(list==<span class="keyword">null</span>) &#123;<span class="comment">//首次购买</span></span><br><span class="line">list =<span class="keyword">new</span> ArrayList&lt;Book&gt;();</span><br><span class="line">session.setAttribute(<span class="string">&quot;cart&quot;</span>, list);</span><br><span class="line">&#125;</span><br><span class="line">list.add(book);</span><br><span class="line">Cookie cookie =<span class="keyword">new</span> Cookie(<span class="string">&quot;JESSIONID&quot;</span>, session.getId());</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">response.sendRedirect(<span class="string">&quot;cart&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###5.创建一个名称为CartServlet的Servlet类，该类主要用于展示用户已经购买的图书列表</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example01;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@WebServlet(&quot;/cart&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CartServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">PrintWriter out=response.getWriter();</span><br><span class="line">List&lt;Book&gt; cart=<span class="keyword">null</span>;</span><br><span class="line">HttpSession session = request.getSession(<span class="keyword">false</span>);</span><br><span class="line"><span class="keyword">boolean</span> cartFlag=<span class="keyword">true</span>;</span><br><span class="line"><span class="keyword">if</span>(session==<span class="keyword">null</span>) &#123;</span><br><span class="line">cartFlag=<span class="keyword">false</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">cart=(List&lt;Book&gt;)session.getAttribute(<span class="string">&quot;cart&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(cart==<span class="keyword">null</span>) &#123;</span><br><span class="line">cartFlag=<span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(!cartFlag) &#123;</span><br><span class="line">out.print(<span class="string">&quot;您的购物车里面没有图书，请前往购买&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">out.print(<span class="string">&quot;购买图书如下：&quot;</span>+<span class="string">&quot;&lt;br/&gt;&quot;</span>);</span><br><span class="line"><span class="keyword">for</span>(Book b:cart) &#123;</span><br><span class="line">out.print(<span class="comment">/*&quot;购买的图书：&quot;+*/</span>b.getName()+<span class="string">&quot;&lt;br/&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>###6.启动Tomcat 服务器，访问ListBookServlet,<br> 1.单击图中“javaweb开发”后的“点击购买”链接<br> 2.再次访问（或点击浏览器的返回上一页）ListBookServlet，选择“jdbc开发”后的“点击购买”链接<br><img src="https://cdn.jsdelivr.net/gh/string32/picgo/img/3.png"></p><h2 id="任务：实现用户登录"><a href="#任务：实现用户登录" class="headerlink" title="任务：实现用户登录 "></a>任务：实现用户登录 </h2><p>实现效果：</p><p>用户登录的整个流程，当用户访问某个网站的首界面时，首先会判断用户是否登录，如果已经登录则在首界面中显示用户登录信息，否则进入登录页面，完成用户登录功能，然后显示用户登录信息。<br>在用户登录的情况下，如果单击用户登录界面中的“退出”时，就会注销当前用户的信息，返回首界面。</p><p>###1.创建封装用户信息类<br>1.在chapter05项目的src下新建一个名称为pidan.session.example02的包,在包中编写一个名称为User的类，<br>User类中包含username和password两个属性以及其getter和setter方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example02;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> String username;</span><br><span class="line"><span class="keyword">private</span> String password;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getUsername</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> username;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUsername</span><span class="params">(String username)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.username = username;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPassword</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> password;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setPassword</span><span class="params">(String password)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.password = password;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.创建Servlet<br>在pidan.session.example02包中编写IndexServlet 类， 该Servlet 用于显示网站的首界面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example02;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@WebServlet(&quot;/IndexServlevt&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">HttpSession session= request.getSession();</span><br><span class="line">User user =(User) session.getAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(user==<span class="keyword">null</span>) &#123;</span><br><span class="line">response.getWriter().print(<span class="string">&quot;您还没登录，请&lt;a href=&#x27;login.html&#x27;&gt;登录&lt;/a&gt;&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">response.getWriter().print(<span class="string">&quot;你已登录，欢迎你，&quot;</span>+user.getUsername()+<span class="string">&quot;!&quot;</span>);</span><br><span class="line">response.getWriter().print(<span class="string">&quot;&lt;a href=&#x27;LogoutServlet&#x27;&gt;退出&lt;/a&gt;&quot;</span>);</span><br><span class="line">Cookie cookie =<span class="keyword">new</span> Cookie(<span class="string">&quot;JSESSIONID&quot;</span>, session.getId());</span><br><span class="line">cookie.setMaxAge(<span class="number">60</span>*<span class="number">30</span>);</span><br><span class="line">cookie.setPath(<span class="string">&quot;/chapter05&quot;</span>);</span><br><span class="line">response.addCookie(cookie);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;**</span><br></pre></td></tr></table></figure><p>3.在pidan.session.example02包中编写LoginServlet,该Servlet用于显<br>示用户登录成功后的界面</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example02;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.PrintWriter;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@WebServlet(&quot;/LoginServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">response.setContentType(<span class="string">&quot;text/html;charset=utf-8&quot;</span>);</span><br><span class="line">String username = request.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">String password = request.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">PrintWriter pw=response.getWriter();</span><br><span class="line"><span class="keyword">if</span>((<span class="string">&quot;pidan&quot;</span>).equals(username)&amp;&amp;(<span class="string">&quot;666&quot;</span>).equals(password)) &#123;</span><br><span class="line">User user = <span class="keyword">new</span> User();</span><br><span class="line">user.setUsername(username);</span><br><span class="line">user.setPassword(password);</span><br><span class="line">request.getSession().setAttribute(<span class="string">&quot;user&quot;</span>, user);</span><br><span class="line">response.sendRedirect(<span class="string">&quot;IndexServlevt&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">pw.write(<span class="string">&quot;用户名或密码错误，登录失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>4.在pidan.session.example02包中编写LogoutServet,该Servlet用于完<br>成用户注销功能，当用户单击【退出】时，该类会将Session对象中的用户信息移除，并跳<br>转到网站的首界面。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bai.session.example02;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@WebServlet(&quot;/LogoutServlet&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogoutServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">request.getSession().removeAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">response.sendRedirect(<span class="string">&quot;IndexServlevt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"><span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">doGet(request, response);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-创建登陆页面"><a href="#3-创建登陆页面" class="headerlink" title="3.创建登陆页面"></a>3.创建登陆页面</h3><p>在chapter05项目的WebContent目录下创建一个名称为login.html的页面，该页面中包含用户登录表单信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Insert title here&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form name=<span class="string">&quot;reg&quot;</span> action=<span class="string">&quot;/chapter05/LoginServlet&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">用户名：&lt;input name=<span class="string">&quot;username&quot;</span> type=<span class="string">&quot;text&quot;</span> /&gt;&lt;br/&gt;</span><br><span class="line">密__码：&lt;input name=<span class="string">&quot;password&quot;</span> type=<span class="string">&quot;password&quot;</span> /&gt;&lt;br/&gt;</span><br><span class="line">&lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交&quot;</span> id=<span class="string">&quot;bt&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>最后登录就行了</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>图片描述</title>
      <link href="/2021/11/04/%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0/%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0/"/>
      <url>/2021/11/04/%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0/%E5%9B%BE%E7%89%87%E6%8F%8F%E8%BF%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><img src=""></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>javaweb 01 - 04</title>
      <link href="/2021/10/29/javaweb/javaweb1/"/>
      <url>/2021/10/29/javaweb/javaweb1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="1-4-博客写在csdn"><a href="#1-4-博客写在csdn" class="headerlink" title=" 1-4 博客写在csdn"></a> 1-4 博客写在csdn</h1><p>这是我的csdn链接，昵称失去梦想的仙宇 点击<a href="https://blog.csdn.net/weixin_55897821?spm=1000.2115.3001.5343">CSDN</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2021/06/29/hello-world/"/>
      <url>/2021/06/29/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
